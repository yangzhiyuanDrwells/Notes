
**对于一个inode来说，设计了12个直接指针索引，一个间接指针索引，一个双间接指针索引，以及一个三间接指针索引**

每个block号码为数字，需要占据4bytes。

#### 假设block的单位容量为1KiB，每个block能记录的block号码为1kiB/4=256

12个直接容量 = 12 * 1kiB =12kiB

单间接容量 = 256 * 1kiB = 256kiB

双间接容量 = 256 * 256 * 1kiB = 65536kiB

三间接容量 = 256 * 256 * 256 * 1kiB = 16777216kiB

单文件最大总量 = 12个直接容量 + 单间接容量 + 双间接容量 + 三间接容量 = (12 + 256 + 65536 + 16777216) / (1024 * 1024) = 16.06GiB


#### 假设block的单位容量为2KiB，每个block能记录的block号码为2kiB/4=512

12个直接容量 = 12 * 2kiB =24kiB

单间接容量 = 512 * 2kiB = 1024kiB

双间接容量 = 512 * 512 * 2kiB = 524288kiB

三间接容量 = 512 * 512 * 512 * 2kiB = 268435456kiB

单文件最大总量 = 12个直接容量 + 单间接容量 + 双间接容量 + 三间接容量 = (24 + 1024 + 524288 + 268435456) / (1024 * 1024) = 256.50GiB

#### 假设block的单位容量为4KiB，每个block能记录的block号码为4kiB/4=1024

12个直接容量 = 12 * 4kiB =48kiB

单间接容量 = 1024 * 4kiB = 4096kiB

双间接容量 = 1024 * 1024 * 4kiB = 4194304kiB

三间接容量 = 1024 * 1024 * 1024 * 4kiB = 4294967296kiB

单文件最大总量 = 12个直接容量 + 单间接容量 + 双间接容量 + 三间接容量 = (48 + 4096 + 4194304 + 4294967296) / (1024 * 1024) = 4299165744/1048576 = 4.10TiB

这个计算方法不能用在4KiB的block大小的情况下，因为大于2KiB的block将会受到ext2文件系统本身的限制，**ext2文件系统限制单个文件最大容量为2T**。

#### 因此下表描述了ext2/ext3文件系统的block 大小与单个文件大小的关系：

|Block大小|1KiB|2KiB|4KiB|8KiB|
|:--|:--|:--|:--|:--|
|单个文件的最大容量|16GiB|256GiB|2TiB|2TiB|
